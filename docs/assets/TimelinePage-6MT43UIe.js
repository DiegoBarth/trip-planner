import{t as e}from"./PageHeader-DITAqTCF.js";import{t}from"./banknote-CdCCmc14.js";import"./CustomSelect-AnwEWycZ.js";import{n,r,t as i}from"./trending-up-CQDk-Kcw.js";import{t as a}from"./circle-check-BOhZa8fZ.js";import{t as o}from"./clock-Cvs7irXo.js";import{n as s,t as c}from"./jspdf.es.min-2PtDXhL5.js";import{n as l,t as u}from"./CountryFilter-BVZwcEv_.js";import"./ThemeToggle-QwLtdSSs.js";import{D as d,I as f,K as p,L as m,O as h,R as g,Z as _,c as v,g as y,i as ee,j as b,k as x,nt as S,v as C,x as w}from"./index-CUM8Gaa4.js";import"./typeof-Cb4gRRCZ.js";import{r as T,t as te}from"./useOSRMRoutesQuery-DkKcKbS3.js";var E=m(`arrow-down`,[[`path`,{d:`M12 5v14`,key:`s699le`}],[`path`,{d:`m19 12-7 7-7-7`,key:`1idqje`}]]),D=m(`car`,[[`path`,{d:`M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2`,key:`5owen`}],[`circle`,{cx:`7`,cy:`17`,r:`2`,key:`u2ysq9`}],[`path`,{d:`M9 17h6`,key:`r8uit2`}],[`circle`,{cx:`17`,cy:`17`,r:`2`,key:`axvx0g`}]]),O=m(`droplets`,[[`path`,{d:`M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z`,key:`1ptgy4`}],[`path`,{d:`M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97`,key:`1sl1rz`}]]),k=m(`thermometer-sun`,[[`path`,{d:`M12 2v2`,key:`tus03m`}],[`path`,{d:`M12 8a4 4 0 0 0-1.645 7.647`,key:`wz5p04`}],[`path`,{d:`M2 12h2`,key:`1t8f8n`}],[`path`,{d:`M20 14.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0z`,key:`yu0u2z`}],[`path`,{d:`m4.93 4.93 1.41 1.41`,key:`149t6j`}],[`path`,{d:`m6.34 17.66-1.41 1.41`,key:`1m8zz5`}]]),A=m(`wind`,[[`path`,{d:`M12.8 19.6A2 2 0 1 0 14 16H2`,key:`148xed`}],[`path`,{d:`M17.5 8a2.5 2.5 0 1 1 2 4H2`,key:`1u4tom`}],[`path`,{d:`M9.8 4.4A2 2 0 1 1 11 8H2`,key:`75valh`}]]),j=S(),M=x();function N(e,t){let n=`https://www.google.com/maps/search/?api=1&query=${e},${t}`;window.open(n,`_blank`)}function P({attraction:e,arrivalTime:r,departureTime:i,duration:s,conflicts:c,onToggleVisited:u}){let d=g[e.type],f=c.some(e=>e.severity===`error`),m=c.some(e=>e.severity===`warning`),h=e.visited,_=e.id===-999,v=e.lat&&e.lng;return(0,M.jsxs)(`div`,{className:`relative`,children:[(0,M.jsx)(`div`,{className:`
          absolute left-0 top-6 w-3 h-3 md:w-3.5 md:h-3.5 rounded-full border-2 border-white shadow z-20 -translate-x-1/2
          ${h?`bg-emerald-500`:`bg-slate-400`}
        `}),(0,M.jsxs)(`div`,{className:`
          relative ml-4 md:ml-6 rounded-2xl shadow-xl overflow-hidden transition-all border-l-4
          ${f?`border-l-red-500`:``}
          ${m&&!f?`border-l-amber-500`:``}
          ${h&&!f&&!m?`border-l-emerald-500`:``}
          ${!f&&!m&&!h?`border-l-slate-400`:``}
          ${h?`opacity-95`:``}
        `,children:[(0,M.jsx)(`div`,{className:`absolute inset-0 bg-cover bg-center`,style:{backgroundImage:`url(${e.imageUrl})`}}),(0,M.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-t from-black/90 via-black/60 to-black/50`}),(0,M.jsxs)(`div`,{className:`relative z-10 p-4 text-white`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-2 mb-3 pb-2 border-b border-white/20`,children:[(0,M.jsx)(o,{className:`w-4 h-4 text-white/80 flex-shrink-0`}),(0,M.jsxs)(`div`,{className:`flex items-center gap-2 text-sm font-medium flex-1 text-shadow`,children:[(0,M.jsx)(`span`,{className:`font-bold`,children:r}),(0,M.jsx)(`span`,{className:`text-white/60`,children:`‚Üí`}),(0,M.jsx)(`span`,{className:`font-bold`,children:i}),(0,M.jsxs)(`span`,{className:`text-xs text-white/70`,children:[`(`,s,`min)`]})]}),v&&(0,M.jsx)(`button`,{onClick:t=>{t.stopPropagation(),N(e.lat,e.lng)},className:`p-1.5 rounded-full bg-white/20 hover:bg-white/30 backdrop-blur-sm transition-all`,title:`Abrir no Google Maps`,children:(0,M.jsx)(n,{className:`w-5 h-5 text-white`})}),!_&&(0,M.jsx)(`button`,{onClick:t=>{t.stopPropagation(),u?.(e.id)},className:`
                  p-1.5 rounded-full backdrop-blur-sm transition-all
                  ${h?`bg-emerald-500/30 hover:bg-emerald-500/40`:`bg-white/20 hover:bg-white/30`}
                `,title:h?`Marcar como n√£o visitado`:`Marcar como visitado`,children:(0,M.jsx)(a,{className:`w-5 h-5 ${h?`text-emerald-300`:`text-white`}`})})]}),(0,M.jsx)(`h3`,{className:`text-lg font-bold mb-2 line-clamp-2 drop-shadow-md text-shadow`,children:e.name}),(0,M.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-white/80 mb-2 text-shadow`,children:[(0,M.jsx)(l,{className:`w-3.5 h-3.5 flex-shrink-0`}),(0,M.jsxs)(`span`,{children:[e.region?`${e.region}, `:``,e.city]})]}),!_&&(0,M.jsxs)(`div`,{className:`flex items-center gap-2 text-sm mb-3`,children:[(0,M.jsx)(t,{className:`w-3.5 h-3.5 text-emerald-300 flex-shrink-0`}),e.couplePrice?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(`span`,{className:`font-semibold text-emerald-300`,children:C(e.couplePrice,e.currency)}),(0,M.jsxs)(`span`,{className:`text-white/70 text-xs`,children:[`(`,C(e.priceInBRL),`)`]})]}):(0,M.jsx)(`span`,{className:`font-semibold text-emerald-300`,children:`Gratuito`})]}),!_&&(0,M.jsxs)(`div`,{className:`flex flex-wrap gap-2 mb-3`,children:[d&&(0,M.jsx)(`span`,{className:`px-2 py-1 bg-white/20 text-white text-xs rounded-md backdrop-blur-sm`,children:d.label}),e.needsReservation&&e.reservationStatus&&(0,M.jsxs)(`span`,{className:`px-2 py-1 bg-white/20 text-white text-xs rounded-md backdrop-blur-sm flex items-center gap-1`,children:[(0,M.jsx)(`span`,{children:p[e.reservationStatus].icon}),(0,M.jsx)(`span`,{children:p[e.reservationStatus].label})]})]}),c.length>0&&(0,M.jsx)(`div`,{className:`space-y-2 mb-3`,children:c.map((e,t)=>(0,M.jsxs)(`div`,{className:`
                    flex items-start gap-2 text-sm p-2.5 rounded-lg backdrop-blur-sm border
                    ${e.severity===`error`?`bg-red-500/20 border-red-400/40 text-red-200`:`bg-amber-500/20 border-amber-400/40 text-amber-200`}
                  `,children:[(0,M.jsx)(b,{className:`w-4 h-4 flex-shrink-0 mt-0.5`}),(0,M.jsx)(`span`,{className:`font-medium`,children:e.message})]},t))}),e.notes&&(0,M.jsxs)(`div`,{className:`text-sm bg-white/10 p-3 rounded-xl backdrop-blur-sm border border-white/20`,children:[(0,M.jsx)(`span`,{className:`font-semibold`,children:`üí°`}),` `,e.notes]})]})]})]})}function F({segment:e}){let t=()=>{switch(e.travelMode){case`walking`:return(0,M.jsx)(i,{className:`w-4 h-4`});case`driving`:return(0,M.jsx)(D,{className:`w-4 h-4`});case`transit`:return(0,M.jsx)(D,{className:`w-4 h-4`});default:return(0,M.jsx)(E,{className:`w-4 h-4`})}},n=()=>{switch(e.travelMode){case`walking`:return`A p√©`;case`driving`:return`Carro`;case`transit`:return`Transporte`;default:return`Deslocamento`}};return(0,M.jsxs)(`div`,{className:`relative flex items-center pb-6`,children:[(0,M.jsx)(`div`,{className:`absolute left-0 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-slate-400 dark:bg-slate-500 z-10 -translate-x-1/2`,"aria-hidden":!0}),(0,M.jsxs)(`div`,{className:`ml-4 md:ml-6 flex flex-col md:flex-row md:items-center gap-2 md:gap-4 px-4 py-3 rounded-2xl shadow-md border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 w-full md:w-auto`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-2 text-gray-700 dark:text-gray-200`,children:[(0,M.jsx)(`span`,{className:`flex items-center justify-center w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300`,children:t()}),(0,M.jsx)(`span`,{className:`text-sm md:text-base font-semibold`,children:n()})]}),(0,M.jsx)(`div`,{className:`hidden md:block h-5 w-px bg-gray-200 dark:bg-gray-600`}),(0,M.jsxs)(`div`,{className:`flex items-center gap-3 md:gap-4 text-sm`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-1.5 text-gray-600 dark:text-gray-300`,children:[(0,M.jsx)(o,{className:`w-4 h-4 text-gray-500 dark:text-gray-400`}),(0,M.jsx)(`span`,{className:`font-semibold text-gray-900 dark:text-gray-100`,children:e.durationMinutes}),(0,M.jsx)(`span`,{children:`min`})]}),(0,M.jsx)(`span`,{className:`text-gray-300 dark:text-gray-600`,children:`‚Ä¢`}),(0,M.jsxs)(`div`,{className:`flex items-center gap-1 text-gray-600 dark:text-gray-300`,children:[(0,M.jsx)(`span`,{className:`font-semibold text-gray-900 dark:text-gray-100`,children:e.distanceKm.toFixed(1)}),(0,M.jsx)(`span`,{children:`km`})]})]})]})]})}var I=`b996f53f6015bd09f1e15db7dba0ea21`,L=`https://api.openweathermap.org/data/2.5`,R={Tokyo:{lat:35.6762,lon:139.6503},T√≥quio:{lat:35.6762,lon:139.6503},Kyoto:{lat:35.0116,lon:135.7681},Osaka:{lat:34.6937,lon:135.5023},Nara:{lat:34.6851,lon:135.8048},Hiroshima:{lat:34.3853,lon:132.4553},Hakone:{lat:35.2328,lon:139.107},Seoul:{lat:37.5665,lon:126.978},Seul:{lat:37.5665,lon:126.978},Busan:{lat:35.1796,lon:129.0756},Jeju:{lat:33.4996,lon:126.5312},Incheon:{lat:37.4563,lon:126.7052},Daegu:{lat:35.8714,lon:128.6014}};function z(e){let t=e.substring(0,2);return{"01":`‚òÄÔ∏è`,"02":`üå§Ô∏è`,"03":`‚òÅÔ∏è`,"04":`‚òÅÔ∏è`,"09":`üåßÔ∏è`,10:`üå¶Ô∏è`,11:`‚õàÔ∏è`,13:`‚ùÑÔ∏è`,50:`üå´Ô∏è`}[t]||`üå§Ô∏è`}async function B(e){let t=R[e];if(!t)return console.warn(`Coordinates not found for city: ${e}`),[];try{let e=`${L}/forecast?lat=${t.lat}&lon=${t.lon}&appid=${I}&units=metric&lang=pt_br`,n=new AbortController,r=setTimeout(()=>n.abort(),8e3),i=await fetch(e,{signal:n.signal});if(clearTimeout(r),!i.ok)return console.error(`Weather API error:`,i.status),[];let a=await i.json();if(!a.list||a.list.length===0)return[];let o=a.city?.timezone??0,s=e=>{let t=new Date((e+o)*1e3);return{date:t.toISOString().slice(0,10),hour:t.getUTCHours()}},c={};a.list.forEach(e=>{let{date:t,hour:n}=s(e.dt);c[t]||(c[t]=[]),c[t].push({hour:n,item:e})});let l=[];return Object.entries(c).forEach(([e,t])=>{if(t.length===0)return;let n=Math.min(...t.map(e=>e.item.main.temp_min)),r=Math.max(...t.map(e=>e.item.main.temp_max)),i=Math.max(...t.map(e=>e.item.pop||0)),a=(t.find(e=>e.hour===12)||t[Math.floor(t.length/2)]||t[0]).item,o=e=>t.find(t=>t.hour===e)?.item,s=e=>e?{temp:Math.round(e.main.temp),icon:z(e.weather[0].icon),description:e.weather[0].description,pop:e.pop||0}:void 0,c=o(9)||o(6),u=o(15)||o(12),d=o(21)||o(18);l.push({date:e,temp:Math.round(a.main.temp),tempMin:Math.round(n),tempMax:Math.round(r),description:a.weather[0].description,icon:z(a.weather[0].icon),humidity:a.main.humidity,windSpeed:a.wind.speed,pop:i,rain:a.rain?.[`3h`]||0,periods:{...c&&{morning:s(c)},...u&&{afternoon:s(u)},...d&&{evening:s(d)}}})}),l.sort((e,t)=>e.date.localeCompare(t.date))}catch(e){return console.error(`Error fetching weather:`,e),[]}}function V(e){if(!e||typeof e!=`string`)return``;let t=e.trim();if(t.includes(`T`))return t.split(`T`)[0];if(t.includes(`/`)){let e=t.split(`/`).map(e=>e.trim());if(e.length===3){let t=e[2].length===4,n=e[0].length===4;if(t){let[t,n,r]=e;return`${r}-${n.padStart(2,`0`)}-${t.padStart(2,`0`)}`}if(n){let[t,n,r]=e;return`${t}-${n.padStart(2,`0`)}-${r.padStart(2,`0`)}`}}}if(/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)){let[e,n,r]=t.split(`-`);return`${e}-${n.padStart(2,`0`)}-${r.padStart(2,`0`)}`}return t}function H(e,t){let n=V(t);return!n||!e?.length?null:e.find(e=>e.date===n)||null}function U(e){return e.pop>.7?`‚òî Alta chance de chuva - leve guarda-chuva`:e.pop>.4?`üåÇ Possibilidade de chuva - considere levar guarda-chuva`:e.temp>30?`üå°Ô∏è Muito calor - use protetor solar e hidrate-se`:e.temp<10?`üß• Frio - leve casaco`:e.windSpeed>10?`üí® Vento forte - se agasalhe`:e.description.toLowerCase().includes(`neve`)?`‚ùÑÔ∏è Neve - vista roupas apropriadas`:`‚úÖ Clima favor√°vel para passeios`}function W({weather:e}){let t=U(e),n=e.pop>.4,r=e.periods,i=r&&(r.morning||r.afternoon||r.evening);return(0,M.jsxs)(`div`,{className:`
      border-2 rounded-lg p-3 
      ${n?`bg-blue-50 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700`:`bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700`}
    `,children:[(0,M.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,M.jsx)(`span`,{className:`text-3xl`,children:e.icon}),(0,M.jsxs)(`div`,{children:[(0,M.jsxs)(`div`,{className:`text-2xl font-bold text-gray-900 dark:text-gray-100`,children:[e.tempMin,`¬∞ - `,e.tempMax,`¬∞`]}),(0,M.jsx)(`div`,{className:`text-xs text-gray-600 dark:text-gray-400 capitalize`,children:e.description})]})]}),(0,M.jsx)(`div`,{className:`text-sm text-gray-600 dark:text-gray-400 text-right`,children:(0,M.jsxs)(`div`,{className:`flex items-center gap-1 justify-end`,children:[(0,M.jsx)(k,{className:`w-4 h-4`}),(0,M.jsx)(`span`,{children:`min / max`})]})})]}),i&&(0,M.jsxs)(`div`,{className:`flex flex-wrap items-center gap-x-4 gap-y-1.5 text-sm text-gray-700 dark:text-gray-300 mb-3 pb-2 border-b border-gray-200 dark:border-gray-600`,children:[r.morning&&(0,M.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,M.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Manh√£`}),(0,M.jsx)(`span`,{children:r.morning.icon}),(0,M.jsxs)(`span`,{className:`font-semibold`,children:[r.morning.temp,`¬∞`]}),r.morning.pop>.3&&(0,M.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.morning.pop*100),`%`]})]}),r.afternoon&&(0,M.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,M.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Tarde`}),(0,M.jsx)(`span`,{children:r.afternoon.icon}),(0,M.jsxs)(`span`,{className:`font-semibold`,children:[r.afternoon.temp,`¬∞`]}),r.afternoon.pop>.3&&(0,M.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.afternoon.pop*100),`%`]})]}),r.evening&&(0,M.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,M.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Noite`}),(0,M.jsx)(`span`,{children:r.evening.icon}),(0,M.jsxs)(`span`,{className:`font-semibold`,children:[r.evening.temp,`¬∞`]}),r.evening.pop>.3&&(0,M.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.evening.pop*100),`%`]})]})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400 mb-2`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,M.jsx)(O,{className:`w-3 h-3`}),(0,M.jsxs)(`span`,{children:[`at√© `,Math.round(e.pop*100),`% chuva`]})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,M.jsx)(A,{className:`w-3 h-3`}),(0,M.jsxs)(`span`,{children:[e.windSpeed.toFixed(1),` m/s`]})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-1`,children:[`üíß `,e.humidity,`%`]})]}),(0,M.jsx)(`div`,{className:`
        text-xs font-medium p-2 rounded
        ${n?`bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200`:`bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200`}
      `,children:t})]})}function G(e){let{data:t=[],isLoading:n,error:r}=d({queryKey:[`weather`,e],queryFn:()=>B(e),staleTime:1e3*60*30,enabled:!!e,retry:1});return{forecast:t,isLoading:n,error:r}}function K({timeline:e,city:t,date:n,onToggleVisited:a}){let s=t??e?.attractions[0]?.city??``,c=n??e?.date??``,{forecast:u}=G(s),d=c&&u.length>0?H(u,y(c)):null;return e?(0,M.jsxs)(`div`,{className:`space-y-6`,children:[c&&(d?(0,M.jsx)(W,{weather:d}):(0,M.jsx)(`div`,{className:`rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 p-4 text-amber-800 dark:text-amber-200 text-sm`,children:`Clima n√£o dispon√≠vel para esta data. A previs√£o cobre apenas os pr√≥ximos 5 dias.`})),(0,M.jsx)(`div`,{className:`bg-gradient-to-br from-slate-600 to-slate-700 dark:from-slate-700 dark:to-slate-800 text-white rounded-2xl p-5 md:p-6 shadow-lg`,children:(0,M.jsxs)(`div`,{className:`space-y-4`,children:[(0,M.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,M.jsxs)(`div`,{className:`text-sm font-medium opacity-90 mb-1`,children:[`Dia `,e.dayNumber]}),(0,M.jsx)(`h2`,{className:`text-lg md:text-3xl font-bold mb-2 capitalize`,children:w(e.date)})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-2 text-base md:text-lg opacity-90`,children:[(0,M.jsx)(o,{className:`w-5 h-5`}),(0,M.jsx)(`span`,{className:`font-semibold`,children:e.startTime}),(0,M.jsx)(`span`,{children:`‚Üí`}),(0,M.jsx)(`span`,{className:`font-semibold`,children:e.endTime})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-6 pt-4 border-t border-white/20 text-sm md:text-base`,children:[(0,M.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,M.jsx)(l,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,M.jsxs)(`div`,{children:[(0,M.jsx)(`div`,{className:`font-bold text-md:text-xl`,children:e.attractions.length}),(0,M.jsx)(`div`,{className:`text-xs opacity-75`,children:`locais`})]})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,M.jsx)(i,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,M.jsxs)(`div`,{children:[(0,M.jsxs)(`div`,{className:`font-bold text-md md:text-xl`,children:[e.totalDistance.toFixed(1),` km`]}),(0,M.jsx)(`div`,{className:`text-xs opacity-75`,children:`dist√¢ncia`})]})]}),(0,M.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,M.jsx)(o,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,M.jsxs)(`div`,{children:[(0,M.jsxs)(`div`,{className:`font-bold text-md md:text-xl`,children:[e.totalTravelTime,`min`]}),(0,M.jsx)(`div`,{className:`text-xs opacity-75`,children:`viagem`})]})]})]}),e.conflicts.length>0&&(0,M.jsxs)(`div`,{className:`mt-4 bg-white/10 backdrop-blur rounded-xl p-4 flex items-start gap-3`,children:[(0,M.jsx)(r,{className:`w-6 h-6 flex-shrink-0 mt-0.5`}),(0,M.jsxs)(`div`,{children:[(0,M.jsxs)(`div`,{className:`font-semibold text-base`,children:[e.conflicts.length,` `,e.conflicts.length===1?`conflito detectado`:`conflitos detectados`]}),(0,M.jsx)(`div`,{className:`text-sm opacity-90 mt-1`,children:`Verifique os avisos abaixo`})]})]})]})}),(0,M.jsxs)(`div`,{className:`relative pl-3 md:pl-6 pt-2`,children:[(0,M.jsx)(`div`,{className:`absolute left-0 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700 rounded-full`,"aria-hidden":!0}),(0,M.jsx)(`div`,{className:`space-y-6`,children:e.attractions.map((t,n)=>{let r=n>0?e.segments[n-1]:null,i=e.conflicts.filter(e=>e.attractionId===t.id),o=t.arrivalTime||e.startTime,s=t.departureTime||e.startTime,c=t.duration||60;return(0,M.jsxs)(`div`,{className:`relative`,children:[r&&(0,M.jsx)(F,{segment:r}),(0,M.jsx)(P,{attraction:t,arrivalTime:o,departureTime:s,duration:c,conflicts:i,onToggleVisited:a})]},t.id)})})]})]}):(0,M.jsxs)(`div`,{className:`text-center py-12`,children:[(0,M.jsx)(f,{className:`w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-3`}),(0,M.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400`,children:`Nenhuma atra√ß√£o para mostrar na timeline`}),(0,M.jsx)(`p`,{className:`text-sm text-gray-500 dark:text-gray-400 mt-1`,children:`Adicione atra√ß√µes com coordenadas para visualizar o roteiro`})]})}var q=18,J=210,Y=297,X=5,ne=8;function re(e){return e.duration===0?0:e.duration??60}function Z(e,t,n){let r=t;return r+n>Y-q+20&&(e.addPage(),r=q),r}function Q(e){let t=new c,n=q;t.setFillColor(51,65,85),t.rect(0,0,J,36,`F`),t.setFontSize(22),t.setFont(`helvetica`,`bold`),t.setTextColor(255,255,255),t.text(`Timeline do Roteiro`,J/2,22,{align:`center`}),t.setFontSize(10),t.setFont(`helvetica`,`normal`),t.setTextColor(226,232,240);let r=e.length===1?`Dia ${e[0].dayNumber} ¬∑ ${w(e[0].date)}`:`${e.length} dias ¬∑ ${w(e[0].date)} ‚Äì ${w(e[e.length-1].date)}`;t.text(r,J/2,30,{align:`center`}),n=42,t.setFontSize(8),t.setTextColor(100,116,139),t.setFont(`helvetica`,`normal`);let i=new Date().toLocaleDateString(`pt-BR`,{day:`2-digit`,month:`long`,year:`numeric`,hour:`2-digit`,minute:`2-digit`});t.text(`Gerado em ${i}`,J/2,n,{align:`center`}),n+=8,t.setDrawColor(226,232,240),t.line(q,n,J-q,n),n+=6;for(let r=0;r<e.length;r++){let i=e[r];n=Z(t,n,50),t.setFillColor(71,85,105),t.rect(q,n,J-q*2,20,`F`),t.setFontSize(12),t.setFont(`helvetica`,`bold`),t.setTextColor(255,255,255),t.text(`Dia ${i.dayNumber}`,q+5,n+8),t.setFontSize(9),t.setFont(`helvetica`,`normal`),t.setTextColor(226,232,240),t.text(w(i.date),q+5,n+14),t.setFontSize(9),t.text(`${i.startTime} - ${i.endTime}`,J-q-6,n+11,{align:`right`}),n+=24,t.setFontSize(8),t.setTextColor(100,116,139),t.setFont(`helvetica`,`normal`),t.text(`${i.attractions.length} locais`,q,n),t.text(`${i.totalDistance.toFixed(1)} km`,q+40,n),t.text(`${i.totalTravelTime} min viagem`,q+75,n),n+=X+2,t.setFont(`helvetica`,`bold`),t.setFontSize(9),t.setTextColor(30,41,59),t.text(`Roteiro`,q,n),n+=X+1;for(let e=0;e<i.attractions.length;e++){if(n=Z(t,n,X*4),e>0&&i.segments[e-1]){let r=i.segments[e-1];t.setFontSize(7),t.setFont(`helvetica`,`normal`),t.setTextColor(148,163,184),t.text(`${r.distanceKm.toFixed(1)} km, ~${r.durationMinutes} min ate ${r.to.name}`,q+8,n),n+=X+1}let r=i.attractions[e],a=r.arrivalTime??i.startTime,o=r.departureTime??i.startTime,s=re(r),c=r.id===-999;n=Z(t,n,X*2+6);let l=X+5;t.setFillColor(248,250,252),t.rect(q,n-3,J-q*2,l,`F`),t.setFontSize(9),t.setFont(`helvetica`,`bold`),t.setTextColor(51,65,85),t.text(`${e+1}. ${r.name}`,q+5,n+1.5),t.setFont(`helvetica`,`normal`),t.setFontSize(8),t.setTextColor(100,116,139),t.text(`${a} - ${o}`,J-q-5,n+1.5,{align:`right`}),r.city&&t.text(r.city,q+5,n+1.5+X),!c&&s>0&&t.text(`${s} min`,J-q-5,n+1.5+X,{align:`right`}),n+=l+2}if(i.conflicts.length>0){let e=5+i.conflicts.length*(X+.5);n=Z(t,n,e+4),t.setFillColor(254,226,226),t.roundedRect(q,n,J-q*2,e,1.5,1.5,`F`),t.setFontSize(8),t.setFont(`helvetica`,`bold`),t.setTextColor(185,28,28),t.text(`Aten√ß√£o: ${i.conflicts.length} conflito(s)`,q+5,n+4),t.setFont(`helvetica`,`normal`),t.setFontSize(7),t.setTextColor(127,29,29),i.conflicts.forEach((e,r)=>{t.text(`‚Ä¢ ${e.message}`,q+5,n+4+(r+1)*(X+.5))}),n+=e+2}n+=ne}let a=Y-12;t.setFontSize(8),t.setTextColor(148,163,184),t.text(`Trip Planner ¬∑ Timeline do Roteiro`,J/2,a,{align:`center`});let o=e.length===1?`timeline-dia-${e[0].dayNumber}-${y(e[0].date)}.pdf`:`timeline-roteiro-${new Date().toISOString().split(`T`)[0]}.pdf`;t.save(o)}function $(e,t){if(e.length===0||t.length===0)return e;let n=e[0].city,r=t.find(e=>e.city===n);return!r?.lat||!r?.lng?e:[{id:-999,name:r.description,lat:r.lat,lng:r.lng,city:r.city,region:e[0].region,country:r.country,order:0,date:e[0].date,day:e[0].day,dayOfWeek:e[0].dayOfWeek,type:`other`,duration:0,couplePrice:0,priceInBRL:0,currency:e[0].currency,visited:!1,needsReservation:!1,openingTime:void 0,closingTime:void 0,imageUrl:void 0},...e]}function ie(){let{country:t,day:n,accommodations:r,attractions:i,isReady:a}=ee(),{toggleVisited:o}=v(t),{segmentsByDay:c,isRoutesLoading:l}=te((0,j.useMemo)(()=>{let e={};return i.filter(e=>e.lat!=null&&e.lng!=null).forEach(t=>{e[t.day]||(e[t.day]=[]),e[t.day].push(t)}),e},[i]),r),{success:d,error:p}=h(),[m,g]=(0,j.useState)(!1),y=async e=>{try{await o(e),d(`Status da atra√ß√£o atualizado`)}catch(e){p(`Erro ao atualizar atra√ß√£o`),console.error(e)}},b=(0,j.useMemo)(()=>i.filter(e=>e.lat&&e.lng),[i]),x=(0,j.useMemo)(()=>b.length===0||n===`all`?[]:$(b.filter(e=>e.day===n),r),[b,n,r]),S=(0,j.useMemo)(()=>{if(n!==`all`||b.length===0)return[];let e={};return b.forEach(t=>{e[t.day]||(e[t.day]=[]),e[t.day].push(t)}),Object.keys(e).map(Number).sort((e,t)=>e-t).map(t=>{let n=e[t],i=$(n,r);return{day:t,date:n[0].date,attractions:i}})},[n,b,r]),C=(0,j.useMemo)(()=>n===`all`?S.length===0?`Todos os dias`:`${S.length} ${S.length===1?`dia`:`dias`}`:x.length===0?``:`Dia ${n}`,[n,S.length,x.length]),w=n===`all`?S.length>0:x.length>0,E=(0,j.useMemo)(()=>n===`all`?JSON.stringify(S.map(e=>({day:e.day,ids:e.attractions.map(e=>e.id)}))):JSON.stringify(x.map(e=>e.id)),[n,S,x]),[D,O]=(0,j.useState)(null),[k,A]=(0,j.useState)([]),[N,P]=(0,j.useState)(!1);return(0,j.useEffect)(()=>{if(l)return;if(n!==`all`){if(x.length===0){O(null),P(!1);return}let e=!1;P(!0),A([]);let t=c[Number(n)];return T(x,t&&t.length===x.length-1?t:void 0).then(t=>{e||O(t)}).finally(()=>{e||P(!1)}),()=>{e=!0}}if(S.length===0){A([]),O(null),P(!1);return}let e=!1;return P(!0),O(null),Promise.all(S.map(e=>{let t=c[e.day],n=t&&t.length===e.attractions.length-1?t:void 0;return T(e.attractions,n)})).then(t=>{e||A(t)}).finally(()=>{e||P(!1)}),()=>{e=!0}},[E,c,l]),a?(0,M.jsxs)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-6`,children:[(0,M.jsx)(e,{title:`Timeline`,subtitle:`${C} - Visualize seu dia com rotas e clima`,filter:(0,M.jsx)(u,{hideGeneralOption:!0}),action:w?(0,M.jsxs)(`button`,{type:`button`,onClick:async()=>{if(w){g(!0);try{if(n===`all`){let e=(k.length===S.length?k:await Promise.all(S.map(e=>{let t=c[e.day],n=t&&t.length===e.attractions.length-1?t:void 0;return T(e.attractions,n)}))).filter(e=>e!=null);e.length>0?(Q(e),d(`PDF exportado com sucesso!`)):p(`Nenhuma timeline gerada para exportar`)}else{let e=c[Number(n)],t=e&&e.length===x.length-1?e:void 0,r=D??await T(x,t);r?(Q([r]),d(`PDF exportado com sucesso!`)):p(`Nenhuma timeline gerada para exportar`)}}catch(e){console.error(e),p(`Erro ao exportar PDF`)}finally{g(!1)}}},disabled:m,className:`flex items-center gap-2 px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-white text-sm font-medium transition-colors disabled:opacity-60 disabled:cursor-not-allowed`,title:`Exportar timeline em PDF`,children:[(0,M.jsx)(s,{className:`w-4 h-4`}),m?`Exportando‚Ä¶`:`Exportar PDF`]}):void 0}),(0,M.jsxs)(`main`,{className:`max-w-6xl mx-auto px-4 md:px-6 py-6`,children:[!1,(n===`all`?S.length===0:x.length===0)?(0,M.jsxs)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-12 text-center`,children:[(0,M.jsx)(f,{className:`w-16 h-16 text-gray-400 mx-auto mb-4`}),(0,M.jsx)(`h3`,{className:`text-xl font-bold text-gray-900 dark:text-gray-100 mb-2`,children:n===`all`?`Nenhuma atra√ß√£o com coordenadas`:`Nenhuma atra√ß√£o para o Dia ${n}`}),(0,M.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mb-4`,children:n===`all`?`Adicione coordenadas (lat/lng) √†s suas atra√ß√µes para visualizar as timelines por dia`:`Adicione coordenadas (lat/lng) √†s suas atra√ß√µes para visualizar a timeline`}),(0,M.jsx)(_,{to:`/attractions`,className:`inline-block px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors`,children:`Ir para Atra√ß√µes`})]}):l?(0,M.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center`,children:(0,M.jsx)(`p`,{className:`text-gray-500 dark:text-gray-400 text-sm`,children:`Carregando rotas em segundo plano...`})}):N?(0,M.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-12 flex items-center justify-center min-h-[200px]`,children:(0,M.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-2 border-gray-200 dark:border-gray-700 border-t-slate-600 dark:border-t-slate-400`})}):n===`all`?(0,M.jsx)(`div`,{className:`space-y-10`,children:S.map((e,t)=>(0,M.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-6`,children:(0,M.jsx)(K,{timeline:k[t]??null,city:e.attractions[0]?.city,date:e.date,onToggleVisited:y})},e.day))}):(0,M.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-6`,children:(0,M.jsx)(K,{timeline:D,city:x[0]?.city,date:x[0]?.date,onToggleVisited:y})})]}),(n===`all`?S.length>0:x.length>0)&&(0,M.jsx)(`div`,{className:`max-w-6xl mx-auto px-6 pb-6`,children:(0,M.jsxs)(`div`,{className:`bg-blue-50 border border-blue-200 rounded-lg p-4`,children:[(0,M.jsxs)(`h4`,{className:`font-semibold text-blue-900 mb-2 flex items-center gap-2`,children:[(0,M.jsx)(f,{className:`w-4 h-4`}),`Como funciona a Timeline`]}),(0,M.jsxs)(`ul`,{className:`text-sm text-blue-800 space-y-1`,children:[(0,M.jsx)(`li`,{children:`‚Ä¢ Rotas calculadas automaticamente usando OSRM`}),(0,M.jsx)(`li`,{children:`‚Ä¢ Tempo de deslocamento estimado com base na dist√¢ncia`}),(0,M.jsx)(`li`,{children:`‚Ä¢ Conflitos detectados automaticamente (hor√°rios, fechamentos)`}),(0,M.jsx)(`li`,{children:`‚Ä¢ Dura√ß√£o: use o campo "Dura√ß√£o" da atra√ß√£o (padr√£o: 60min se n√£o informado)`}),(0,M.jsx)(`li`,{children:`‚Ä¢ Use o filtro na home para selecionar o dia da timeline`})]})]})})]}):(0,M.jsx)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center`,children:(0,M.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600`})})}export{ie as default};