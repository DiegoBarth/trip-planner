import{p as e}from"./google-login-button-CK2bO50y.js";import{i as t,o as n,t as r}from"./react-query-BB-sDLdC.js";import{G as i,X as a,Z as o}from"./index-C11sPK8M.js";async function s(e){let t=await o({action:`createExpense`,data:e});if(!t.success||!t.data)throw Error(t.message||`Failed to create expense`);return t.data}async function c(e){let t=await o({action:`updateExpense`,data:e});if(!t.success||!t.data)throw Error(t.message||`Failed to update expense`);return t.data}async function l(e){let t=await o({action:`deleteExpense`,id:e});if(!t.success)throw Error(t.message||`Failed to delete expense`)}async function u(){let e=await a({action:`getExpenses`});return!e.success||!e.data?[]:i(e.data)}var d=[`expenses`];function f(e,t){e.setQueryData(d,e=>e?[...e,t]:[t])}function p(e,t,n){let r=t.id;e.setQueryData(d,e=>e?e.map(e=>e.id===r?n:e):[n])}function m(e,t){e.setQueryData(d,e=>e?e.filter(e=>e.id!==t).map(e=>e.id>t?{...e,id:e.id-1}:e):[])}var h=[`budget_summary`],g=[`expenses`];function _(i){let a=n(),{data:o=[],isLoading:d,error:_}=t({queryKey:g,queryFn:u,staleTime:e}),v=i===`all`?o:o.filter(e=>(e.country??`general`)===i),y=r({mutationFn:e=>s(e),onSuccess:e=>{f(a,e),a.invalidateQueries({queryKey:h})}}),b=r({mutationFn:e=>c(e),onSuccess:e=>{let t=a.getQueryData(g)?.find(t=>t.id===e.id);t&&(p(a,t,e),a.invalidateQueries({queryKey:h}))}}),x=r({mutationFn:e=>l(e),onSuccess:(e,t)=>{a.getQueryData(g)?.find(e=>e.id===t)&&(m(a,t),a.invalidateQueries({queryKey:h}))}});return{expenses:v,isLoading:d,error:_,createExpense:y.mutateAsync,updateExpense:b.mutateAsync,deleteExpense:x.mutateAsync,isCreating:y.isPending,isUpdating:b.isPending,isDeleting:x.isPending}}export{_ as t};