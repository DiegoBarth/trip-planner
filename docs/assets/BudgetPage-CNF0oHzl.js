import{t as e}from"./PageHeader-DITAqTCF.js";import"./CustomSelect-AnwEWycZ.js";import"./ThemeToggle-QwLtdSSs.js";import{t}from"./pencil-yKcOQdmH.js";import{t as n}from"./plus-69omuQw_.js";import{t as r}from"./trash-2-Cx9fm_bg.js";import"./wallet-B0GWwpu1.js";import{A as i,B as a,E as o,I as s,O as c,_ as l,g as u,h as d,i as f,k as p,nt as m,v as h,w as g,x as _,y as v}from"./index-CUM8Gaa4.js";import{a as y,i as b,n as x,o as S,r as C,s as w,t as T}from"./ConfirmModal-CV5TfAVP.js";import{t as E}from"./DateField-CyEolnSy.js";import{t as D}from"./BudgetOriginFilter-CNJFiOuC.js";var O=m(),k=p();function A({budget:e,onClick:t}){let n=a[e.origin];return(0,k.jsx)(`div`,{role:t?`button`:void 0,tabIndex:t?0:void 0,onClick:()=>t?.(e),onKeyDown:n=>{t&&(n.key===`Enter`||n.key===` `)&&(n.preventDefault(),t(e))},className:`group bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden border-l-4 transition-all ${t?`cursor-pointer hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50`:``}`,style:{borderLeftColor:n.color},children:(0,k.jsxs)(`div`,{className:`p-4`,children:[(0,k.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,k.jsx)(`div`,{className:`w-11 h-11 rounded-xl flex items-center justify-center text-xl flex-shrink-0`,style:{backgroundColor:`${n.color}18`},children:n.icon}),(0,k.jsx)(`h3`,{className:`font-semibold text-gray-900 dark:text-gray-100 truncate min-w-0 flex-1`,title:e.description,children:e.description}),(0,k.jsx)(`span`,{className:`text-lg font-bold tabular-nums flex-shrink-0 text-emerald-500 dark:text-emerald-400`,children:h(e.amount)})]}),(0,k.jsxs)(`div`,{className:`pt-3 border-gray-100 dark:border-gray-700 flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400`,children:[(0,k.jsx)(s,{className:`w-4 h-4 text-gray-400 flex-shrink-0`}),(0,k.jsx)(`span`,{children:_(e.date)})]})]})})}var j={origin:`Diego`,description:``,amount:``,date:new Date().toISOString().split(`T`)[0]};function M({budget:e,isOpen:t,onClose:n,onSave:r}){let[i,o]=(0,O.useState)(!1),{control:s,register:c,handleSubmit:f,reset:p,setValue:m,watch:h}=y({defaultValues:j}),_=h(`origin`);return(0,O.useEffect)(()=>{if(t)if(e){let t=Math.round(e.amount*100);p({origin:e.origin,description:e.description,amount:v(t.toString()),date:u(e.date)})}else p(j)},[t,e,p]),(0,k.jsx)(x,{isOpen:t,onClose:n,title:e?`Editar OrÃ§amento`:`Novo OrÃ§amento`,type:e?`edit`:`create`,onSave:f(async e=>{let t=typeof e.amount==`string`?d(e.amount):e.amount,i={origin:e.origin,description:e.description,amount:t||0,date:e.date};o(!0);try{await Promise.resolve(r(i)),p(j),n()}finally{o(!1)}}),loading:i,loadingText:`Salvando...`,size:`md`,children:(0,k.jsxs)(`div`,{className:`space-y-4`,children:[(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Origem do OrÃ§amento *`}),(0,k.jsx)(`div`,{className:`grid grid-cols-3 gap-2`,children:Object.entries(a).map(([e,t])=>(0,k.jsxs)(`button`,{type:`button`,onClick:()=>m(`origin`,e),className:`p-3 rounded-lg border-2 transition-all focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none  ${_===e?`border-current shadow-md`:`border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500`}`,style:{borderColor:_===e?t.color:void 0,backgroundColor:_===e?`${t.color}10`:void 0},children:[(0,k.jsx)(`div`,{className:`text-2xl mb-1`,children:t.icon}),(0,k.jsx)(`div`,{className:`font-semibold text-sm text-gray-500 dark:text-gray-400`,style:{color:_===e?t.color:void 0},children:t.label})]},e))})]}),(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`label`,{htmlFor:`budget-description`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`DescriÃ§Ã£o *`}),(0,k.jsx)(`input`,{id:`budget-description`,type:`text`,required:!0,"aria-required":`true`,autoComplete:`off`,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none`,placeholder:`Ex: OrÃ§amento inicial da viagem`,...c(`description`)})]}),(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`label`,{htmlFor:`budget-amount`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Valor (R$) *`}),(0,k.jsx)(b,{name:`amount`,control:s,render:({field:e})=>(0,k.jsx)(`input`,{id:`budget-amount`,type:`text`,required:!0,"aria-required":`true`,"aria-label":`Valor do or\\u00e7amento em reais`,autoComplete:`off`,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none`,placeholder:`0,00`,value:e.value,onChange:t=>e.onChange(v(t.target.value))})})]}),(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`label`,{htmlFor:`budget-date`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Data *`}),(0,k.jsx)(b,{name:`date`,control:s,render:({field:e})=>(0,k.jsx)(E,{value:e.value?g(e.value):void 0,onChange:t=>e.onChange(t?l(t):``),required:!0})})]})]})})}function N({budget:e,isOpen:n,onClose:o,onEdit:s,onDelete:c}){let l=C(n);if((0,O.useEffect)(()=>{if(!n)return;function e(e){e.key===`Escape`&&o()}return document.addEventListener(`keydown`,e),()=>document.removeEventListener(`keydown`,e)},[n,o]),!n||!e)return null;let u=a[e.origin],d=()=>{o(),s(e)},f=()=>{o(),c(e)};return(0,k.jsxs)(`div`,{className:`fixed inset-0 z-[600] flex justify-center items-end md:items-center`,role:`dialog`,"aria-modal":`true`,"aria-labelledby":`budget-actions-title`,children:[(0,k.jsx)(`div`,{className:`absolute inset-0 bg-black/40 backdrop-blur-sm`,onClick:o,"aria-hidden":`true`}),(0,k.jsxs)(`div`,{ref:l,className:`relative w-full max-w-sm bg-white dark:bg-gray-800 rounded-t-2xl md:rounded-2xl shadow-2xl flex flex-col`,children:[(0,k.jsxs)(`div`,{className:`flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700`,children:[(0,k.jsx)(`h2`,{id:`budget-actions-title`,className:`text-lg font-semibold text-gray-900 dark:text-gray-100 truncate pr-2`,children:e.description}),(0,k.jsx)(`button`,{type:`button`,onClick:o,"aria-label":`Fechar`,className:`p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700`,children:(0,k.jsx)(i,{className:`w-5 h-5`})})]}),(0,k.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-center gap-4 text-sm text-gray-500 dark:text-gray-400 flex-wrap`,children:[u&&(0,k.jsxs)(`span`,{className:`flex items-center gap-2`,children:[(0,k.jsx)(`span`,{children:u.icon}),(0,k.jsx)(`span`,{children:u.label})]}),(0,k.jsx)(`span`,{className:`font-semibold text-gray-700 dark:text-gray-300`,children:h(e.amount)})]}),(0,k.jsxs)(`div`,{className:`flex gap-3 px-4 py-4 border-t border-gray-200 dark:border-gray-700`,children:[(0,k.jsxs)(`button`,{type:`button`,onClick:d,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none`,children:[(0,k.jsx)(t,{className:`w-4 h-4`}),`Editar`]}),(0,k.jsxs)(`button`,{type:`button`,onClick:f,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:outline-none`,children:[(0,k.jsx)(r,{className:`w-4 h-4`}),`Excluir`]})]})]})]})}function P({budgets:e,isLoading:t,onUpdate:n,onCreate:r,onDelete:i}){let[o,s]=(0,O.useState)(!1),[l,u]=(0,O.useState)(),[d,f]=(0,O.useState)(null),[p,m]=(0,O.useState)(null),h=c(),g=e.reduce((e,t)=>(e[t.origin]||(e[t.origin]=[]),e[t.origin].push(t),e),{});Object.keys(g).forEach(e=>{g[e].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())});let _=Object.keys(g).sort((e,t)=>{let n=a[e]?.label??e,r=a[t]?.label??t;return n.localeCompare(r,`pt-BR`)}),v=()=>{u(void 0),s(!1)},y=async e=>{try{l?await n({id:l.id,...e}):await r(e),v()}catch(e){console.error(`Error saving budget:`,e),h.error(`Erro ao salvar orÃ§amento`)}},b=async()=>{d&&(await i(d.id),f(null))},x=e=>{m(e)};return t?null:(0,k.jsxs)(`div`,{children:[(0,k.jsx)(`div`,{className:`space-y-8`,children:_.length===0?(0,k.jsx)(S,{icon:`ðŸ’µ`,title:`Nenhum orÃ§amento encontrado`,description:`Comece adicionando seu primeiro orÃ§amento!`}):_.map(e=>{let t=g[e],n=a[e];return(0,k.jsxs)(`section`,{className:`space-y-4`,children:[(0,k.jsxs)(`div`,{className:`flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-sm w-fit`,children:[(0,k.jsx)(`span`,{className:`text-xl`,children:n.icon}),(0,k.jsx)(`h3`,{className:`text-base font-semibold text-gray-900 dark:text-gray-100`,children:n.label}),(0,k.jsxs)(`span`,{className:`text-sm text-gray-500 dark:text-gray-400`,children:[t.length,` `,t.length===1?`item`:`itens`]})]}),(0,k.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-4`,children:t.map(e=>(0,k.jsx)(A,{budget:e,onClick:x},e.id))})]},e)})}),(0,k.jsx)(M,{budget:l,isOpen:o,onClose:v,onSave:y}),(0,k.jsx)(N,{budget:p,isOpen:!!p,onClose:()=>m(null),onEdit:e=>{m(null),u(e),s(!0)},onDelete:e=>{m(null),f(e)}}),(0,k.jsx)(T,{isOpen:!!d,onClose:()=>f(null),title:`Excluir orÃ§amento`,message:d?(0,k.jsxs)(k.Fragment,{children:[`Tem certeza que deseja excluir "`,d.description,`"?`]}):null,onConfirm:b})]})}function F(){let[t,r]=(0,O.useState)(!1),[i,a]=(0,O.useState)(`all`),{createBudget:s,updateBudget:l,deleteBudget:u}=o(),{budgets:d,isReady:p}=f(),m=c(),h=(0,O.useMemo)(()=>i===`all`?d:d.filter(e=>e.origin===i),[d,i]),g=async e=>{try{let t=await s(e);return m.success(`OrÃ§amento criado com sucesso!`),t}catch(e){throw console.error(`Error creating budget:`,e),m.error(`Erro ao criar orÃ§amento`),e}};return(0,k.jsxs)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-6`,children:[(0,k.jsx)(e,{title:`OrÃ§amento`,subtitle:`Gerencie o orÃ§amento da sua viagem`,filter:(0,k.jsx)(D,{value:i,onChange:a})}),(0,k.jsx)(`main`,{className:`max-w-6xl mx-auto px-4 md:px-6 py-6 mb-12`,children:(0,k.jsx)(P,{budgets:h,isLoading:!p,onCreate:g,onUpdate:async e=>{try{let t=await l(e);return m.success(`OrÃ§amento atualizado com sucesso!`),t}catch(e){throw console.error(`Error updating budget:`,e),m.error(`Erro ao atualizar orÃ§amento`),e}},onDelete:async e=>{try{await u(e),m.success(`OrÃ§amento excluÃ­do com sucesso!`)}catch(e){console.error(`Error deleting budget:`,e),m.error(`Erro ao excluir orÃ§amento`)}}})}),(0,k.jsx)(w,{onClick:()=>r(!0),icon:(0,k.jsx)(n,{className:`w-6 h-6`}),label:`Adicionar`}),t&&(0,k.jsx)(M,{isOpen:t,onClose:()=>r(!1),onSave:async e=>{await g(e),r(!1)}})]})}export{F as default};