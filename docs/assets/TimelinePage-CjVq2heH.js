const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exportTimelineToPDF-BcWLsjUO.js","assets/index-Cz7CaB74.js","assets/router-BCc6NGaV.js","assets/google-login-button-BZ5FbxrR.js","assets/rolldown-runtime-CWU8vmCm.js","assets/react-query-D7qSFt80.js","assets/ui-icons-X4Jx9JeI.js","assets/react-vendor-EEmDTsrY.js","assets/zod-BU_exWGf.js","assets/index-7GlrkACQ.css","assets/jspdf.es.min-jDh3_Rky.js","assets/typeof-_tCs8JoZ.js"])))=>i.map(i=>d[i]);
import{b as e,i as t,p as n,y as r}from"./google-login-button-BZ5FbxrR.js";import"./react-vendor-EEmDTsrY.js";import{n as i,s as a}from"./router-BCc6NGaV.js";import{i as o}from"./react-query-D7qSFt80.js";import{A as s,D as c,H as l,L as u,O as d,Q as f,a as p,b as m,i as h,j as g,m as _,n as v,r as y,t as b,w as x}from"./ui-icons-X4Jx9JeI.js";import"./zod-BU_exWGf.js";import{C as S,E as C,c as w,l as T,n as E,p as D,x as O}from"./index-Cz7CaB74.js";import"./useMediaQuery-mMPbHttp.js";import{t as k}from"./PageHeader-uS0ADHoS.js";import{r as A,t as j}from"./useOSRMRoutesQuery-Bw3HKXyR.js";var M=e(),N=r();function P(e,t){let n=`https://www.google.com/maps/search/?api=1&query=${e},${t}`;window.open(n,`_blank`)}function F({attraction:e,arrivalTime:r,departureTime:i,duration:a,conflicts:o,onToggleVisited:l}){let p=t[e.type],m=o.some(e=>e.severity===`error`),h=o.some(e=>e.severity===`warning`),g=e.visited,_=e.id===-999,v=e.lat&&e.lng;return(0,N.jsxs)(`div`,{className:`relative`,children:[(0,N.jsx)(`div`,{className:`
          absolute left-0 top-6 w-3 h-3 md:w-3.5 md:h-3.5 rounded-full border-2 border-white shadow z-20 -translate-x-1/2
          ${g?`bg-emerald-500`:`bg-slate-400`}
        `}),(0,N.jsxs)(`div`,{className:`
          relative ml-4 md:ml-6 rounded-2xl shadow-xl overflow-hidden transition-all border-l-4
          ${m?`border-l-red-500`:``}
          ${h&&!m?`border-l-amber-500`:``}
          ${g&&!m&&!h?`border-l-emerald-500`:``}
          ${!m&&!h&&!g?`border-l-slate-400`:``}
          ${g?`opacity-95`:``}
        `,children:[(0,N.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-br from-blue-500 to-purple-600`,children:(e.thumbnailUrl||e.imageUrl)?.trim()?(0,N.jsx)(`img`,{src:(e.thumbnailUrl||e.imageUrl||``).trim(),alt:e.name,referrerPolicy:`no-referrer`,loading:`eager`,decoding:`async`,className:`absolute inset-0 w-full h-full object-cover`}):null}),(0,N.jsx)(`div`,{className:`absolute inset-0 bg-gradient-to-t from-black/90 via-black/60 to-black/50 pointer-events-none`}),(0,N.jsxs)(`div`,{className:`relative z-10 pl-4 pr-5 pt-4 pb-4 text-white`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-3 mb-3 pb-2 border-b border-white/20 min-w-0`,children:[(0,N.jsx)(s,{className:`w-4 h-4 text-white/80 flex-shrink-0 self-start mt-0.5`}),(0,N.jsxs)(`div`,{className:`flex flex-wrap items-baseline gap-x-2 gap-y-0.5 text-sm font-medium flex-1 min-w-0 text-shadow`,children:[(0,N.jsx)(`span`,{className:`font-bold`,children:r}),(0,N.jsx)(`span`,{className:`text-white/60`,children:`‚Üí`}),(0,N.jsx)(`span`,{className:`font-bold`,children:i}),(0,N.jsxs)(`span`,{className:`text-xs text-white/70 whitespace-nowrap`,children:[`(`,a,`min)`]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-2 flex-shrink-0`,children:[v&&(0,N.jsx)(`button`,{onClick:t=>{t.stopPropagation(),P(e.lat,e.lng)},className:`p-1.5 rounded-full bg-white/20 hover:bg-white/30 backdrop-blur-sm transition-all`,title:`Abrir no Google Maps`,children:(0,N.jsx)(d,{className:`w-5 h-5 text-white`})}),!_&&(0,N.jsx)(`button`,{onClick:t=>{t.stopPropagation(),l?.(e.id)},className:`
                    p-1.5 rounded-full backdrop-blur-sm transition-all
                    ${g?`bg-emerald-500/30 hover:bg-emerald-500/40`:`bg-white/20 hover:bg-white/30`}
                  `,title:g?`Marcar como n√£o visitado`:`Marcar como visitado`,children:(0,N.jsx)(c,{className:`w-5 h-5 ${g?`text-emerald-300`:`text-white`}`})})]})]}),(0,N.jsx)(`h3`,{className:`text-lg font-bold mb-2 line-clamp-2 drop-shadow-md text-shadow`,children:e.name}),(0,N.jsxs)(`div`,{className:`flex items-center gap-2 text-sm text-white/80 mb-2 text-shadow`,children:[(0,N.jsx)(u,{className:`w-3.5 h-3.5 flex-shrink-0`}),(0,N.jsxs)(`span`,{children:[e.region?`${e.region}, `:``,e.city]})]}),!_&&(0,N.jsxs)(`div`,{className:`flex items-center gap-2 text-sm mb-3`,children:[(0,N.jsx)(x,{className:`w-3.5 h-3.5 text-emerald-300 flex-shrink-0`}),e.couplePrice?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(`span`,{className:`font-semibold text-emerald-300`,children:S(e.couplePrice,e.currency)}),(0,N.jsxs)(`span`,{className:`text-white/70 text-xs`,children:[`(`,S(e.priceInBRL),`)`]})]}):(0,N.jsx)(`span`,{className:`font-semibold text-emerald-300`,children:`Gratuito`})]}),!_&&(0,N.jsxs)(`div`,{className:`flex flex-wrap gap-2 mb-3`,children:[p&&(0,N.jsx)(`span`,{className:`px-2 py-1 bg-white/20 text-white text-xs rounded-md backdrop-blur-sm`,children:p.label}),e.needsReservation&&e.reservationStatus&&(0,N.jsxs)(`span`,{className:`px-2 py-1 bg-white/20 text-white text-xs rounded-md backdrop-blur-sm flex items-center gap-1`,children:[(0,N.jsx)(`span`,{children:n[e.reservationStatus].icon}),(0,N.jsx)(`span`,{children:n[e.reservationStatus].label})]})]}),o.length>0&&(0,N.jsx)(`div`,{className:`space-y-2 mb-3`,children:o.map((e,t)=>(0,N.jsxs)(`div`,{className:`
                    flex items-start gap-2 text-sm p-2.5 rounded-lg backdrop-blur-sm border
                    ${e.severity===`error`?`bg-red-500/20 border-red-400/40 text-red-200`:`bg-amber-500/20 border-amber-400/40 text-amber-200`}
                  `,children:[(0,N.jsx)(f,{className:`w-4 h-4 flex-shrink-0 mt-0.5`}),(0,N.jsx)(`span`,{className:`font-medium`,children:e.message})]},t))}),e.notes&&(0,N.jsxs)(`div`,{className:`text-sm bg-white/10 p-3 rounded-xl backdrop-blur-sm border border-white/20`,children:[(0,N.jsx)(`span`,{className:`font-semibold`,children:`üí°`}),` `,e.notes]})]})]})]})}function I({segment:e}){let t=()=>{switch(e.travelMode){case`walking`:return(0,N.jsx)(g,{className:`w-4 h-4`});case`driving`:return(0,N.jsx)(h,{className:`w-4 h-4`});case`transit`:return(0,N.jsx)(h,{className:`w-4 h-4`});default:return(0,N.jsx)(p,{className:`w-4 h-4`})}},n=()=>{switch(e.travelMode){case`walking`:return`A p√©`;case`driving`:return`Carro`;case`transit`:return`Transporte`;default:return`Deslocamento`}};return(0,N.jsxs)(`div`,{className:`relative flex items-center pb-6`,children:[(0,N.jsx)(`div`,{className:`absolute left-0 top-1/2 -translate-y-1/2 w-2 h-2 rounded-full bg-slate-400 dark:bg-slate-500 z-10 -translate-x-1/2`,"aria-hidden":!0}),(0,N.jsxs)(`div`,{className:`ml-4 md:ml-6 flex flex-col md:flex-row md:items-center gap-2 md:gap-4 px-4 py-3 rounded-2xl shadow-md border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 w-full md:w-auto`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-2 text-gray-700 dark:text-gray-200`,children:[(0,N.jsx)(`span`,{className:`flex items-center justify-center w-8 h-8 rounded-lg bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300`,children:t()}),(0,N.jsx)(`span`,{className:`text-sm md:text-base font-semibold`,children:n()})]}),(0,N.jsx)(`div`,{className:`hidden md:block h-5 w-px bg-gray-200 dark:bg-gray-600`}),(0,N.jsxs)(`div`,{className:`flex items-center gap-3 md:gap-4 text-sm`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-1.5 text-gray-600 dark:text-gray-300`,children:[(0,N.jsx)(s,{className:`w-4 h-4 text-gray-500 dark:text-gray-400`}),(0,N.jsx)(`span`,{className:`font-semibold text-gray-900 dark:text-gray-100`,children:e.durationMinutes}),(0,N.jsx)(`span`,{children:`min`})]}),(0,N.jsx)(`span`,{className:`text-gray-300 dark:text-gray-600`,children:`‚Ä¢`}),(0,N.jsxs)(`div`,{className:`flex items-center gap-1 text-gray-600 dark:text-gray-300`,children:[(0,N.jsx)(`span`,{className:`font-semibold text-gray-900 dark:text-gray-100`,children:e.distanceKm.toFixed(1)}),(0,N.jsx)(`span`,{children:`km`})]})]})]})]})}var L=`b996f53f6015bd09f1e15db7dba0ea21`,R=`https://api.openweathermap.org/data/2.5`,z={Tokyo:{lat:35.6762,lon:139.6503},T√≥quio:{lat:35.6762,lon:139.6503},Kyoto:{lat:35.0116,lon:135.7681},Osaka:{lat:34.6937,lon:135.5023},Nara:{lat:34.6851,lon:135.8048},Hiroshima:{lat:34.3853,lon:132.4553},Hakone:{lat:35.2328,lon:139.107},Seoul:{lat:37.5665,lon:126.978},Seul:{lat:37.5665,lon:126.978},Busan:{lat:35.1796,lon:129.0756},Jeju:{lat:33.4996,lon:126.5312},Incheon:{lat:37.4563,lon:126.7052},Daegu:{lat:35.8714,lon:128.6014}};function B(e){let t=e.substring(0,2);return{"01":`‚òÄÔ∏è`,"02":`üå§Ô∏è`,"03":`‚òÅÔ∏è`,"04":`‚òÅÔ∏è`,"09":`üåßÔ∏è`,10:`üå¶Ô∏è`,11:`‚õàÔ∏è`,13:`‚ùÑÔ∏è`,50:`üå´Ô∏è`}[t]||`üå§Ô∏è`}async function V(e){let t=z[e];if(!t)return console.warn(`Coordinates not found for city: ${e}`),[];try{let e=`${R}/forecast?lat=${t.lat}&lon=${t.lon}&appid=${L}&units=metric&lang=pt_br`,n=new AbortController,r=setTimeout(()=>n.abort(),8e3),i=await fetch(e,{signal:n.signal});if(clearTimeout(r),!i.ok)return console.error(`Weather API error:`,i.status),[];let a=await i.json();if(!a.list||a.list.length===0)return[];let o=a.city?.timezone??0,s=e=>{let t=new Date((e+o)*1e3);return{date:t.toISOString().slice(0,10),hour:t.getUTCHours()}},c={};a.list.forEach(e=>{let{date:t,hour:n}=s(e.dt);c[t]||(c[t]=[]),c[t].push({hour:n,item:e})});let l=[];return Object.entries(c).forEach(([e,t])=>{if(t.length===0)return;let n=Math.min(...t.map(e=>e.item.main.temp_min)),r=Math.max(...t.map(e=>e.item.main.temp_max)),i=Math.max(...t.map(e=>e.item.pop||0)),a=(t.find(e=>e.hour===12)||t[Math.floor(t.length/2)]||t[0]).item,o=e=>t.find(t=>t.hour===e)?.item,s=e=>e?{temp:Math.round(e.main.temp),icon:B(e.weather[0].icon),description:e.weather[0].description,pop:e.pop||0}:void 0,c=o(9)||o(6),u=o(15)||o(12),d=o(21)||o(18);l.push({date:e,temp:Math.round(a.main.temp),tempMin:Math.round(n),tempMax:Math.round(r),description:a.weather[0].description,icon:B(a.weather[0].icon),humidity:a.main.humidity,windSpeed:a.wind.speed,pop:i,rain:a.rain?.[`3h`]||0,periods:{...c&&{morning:s(c)},...u&&{afternoon:s(u)},...d&&{evening:s(d)}}})}),l.sort((e,t)=>e.date.localeCompare(t.date))}catch(e){return console.error(`Error fetching weather:`,e),[]}}function H(e){if(!e||typeof e!=`string`)return``;let t=e.trim();if(t.includes(`T`))return t.split(`T`)[0];if(t.includes(`/`)){let e=t.split(`/`).map(e=>e.trim());if(e.length===3){let t=e[2].length===4,n=e[0].length===4;if(t){let[t,n,r]=e;return`${r}-${n.padStart(2,`0`)}-${t.padStart(2,`0`)}`}if(n){let[t,n,r]=e;return`${t}-${n.padStart(2,`0`)}-${r.padStart(2,`0`)}`}}}if(/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)){let[e,n,r]=t.split(`-`);return`${e}-${n.padStart(2,`0`)}-${r.padStart(2,`0`)}`}return t}function U(e,t){let n=H(t);return!n||!e?.length?null:e.find(e=>e.date===n)||null}function W(e){return e.pop>.7?`‚òî Alta chance de chuva - leve guarda-chuva`:e.pop>.4?`üåÇ Possibilidade de chuva - considere levar guarda-chuva`:e.temp>30?`üå°Ô∏è Muito calor - use protetor solar e hidrate-se`:e.temp<10?`üß• Frio - leve casaco`:e.windSpeed>10?`üí® Vento forte - se agasalhe`:e.description.toLowerCase().includes(`neve`)?`‚ùÑÔ∏è Neve - vista roupas apropriadas`:`‚úÖ Clima favor√°vel para passeios`}function G({weather:e}){let t=W(e),n=e.pop>.4,r=e.periods,i=r&&(r.morning||r.afternoon||r.evening);return(0,N.jsxs)(`div`,{className:`
      border-2 rounded-lg p-3 
      ${n?`bg-blue-50 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700`:`bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700`}
    `,children:[(0,N.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,N.jsx)(`span`,{className:`text-3xl`,children:e.icon}),(0,N.jsxs)(`div`,{children:[(0,N.jsxs)(`div`,{className:`text-2xl font-bold text-gray-900 dark:text-gray-100`,children:[e.tempMin,`¬∞ - `,e.tempMax,`¬∞`]}),(0,N.jsx)(`div`,{className:`text-xs text-gray-600 dark:text-gray-400 capitalize`,children:e.description})]})]}),(0,N.jsx)(`div`,{className:`text-sm text-gray-600 dark:text-gray-400 text-right`,children:(0,N.jsxs)(`div`,{className:`flex items-center gap-1 justify-end`,children:[(0,N.jsx)(b,{className:`w-4 h-4`}),(0,N.jsx)(`span`,{children:`min / max`})]})})]}),i&&(0,N.jsxs)(`div`,{className:`flex flex-wrap items-center gap-x-4 gap-y-1.5 text-sm text-gray-700 dark:text-gray-300 mb-3 pb-2 border-b border-gray-200 dark:border-gray-600`,children:[r.morning&&(0,N.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,N.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Manh√£`}),(0,N.jsx)(`span`,{children:r.morning.icon}),(0,N.jsxs)(`span`,{className:`font-semibold`,children:[r.morning.temp,`¬∞`]}),r.morning.pop>.3&&(0,N.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.morning.pop*100),`%`]})]}),r.afternoon&&(0,N.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,N.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Tarde`}),(0,N.jsx)(`span`,{children:r.afternoon.icon}),(0,N.jsxs)(`span`,{className:`font-semibold`,children:[r.afternoon.temp,`¬∞`]}),r.afternoon.pop>.3&&(0,N.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.afternoon.pop*100),`%`]})]}),r.evening&&(0,N.jsxs)(`span`,{className:`flex items-center gap-1.5`,children:[(0,N.jsx)(`span`,{className:`text-xs font-medium text-gray-500 dark:text-gray-400`,children:`Noite`}),(0,N.jsx)(`span`,{children:r.evening.icon}),(0,N.jsxs)(`span`,{className:`font-semibold`,children:[r.evening.temp,`¬∞`]}),r.evening.pop>.3&&(0,N.jsxs)(`span`,{className:`text-xs text-blue-600 dark:text-blue-400`,children:[Math.round(r.evening.pop*100),`%`]})]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400 mb-2`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,N.jsx)(y,{className:`w-3 h-3`}),(0,N.jsxs)(`span`,{children:[`at√© `,Math.round(e.pop*100),`% chuva`]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,N.jsx)(v,{className:`w-3 h-3`}),(0,N.jsxs)(`span`,{children:[e.windSpeed.toFixed(1),` m/s`]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-1`,children:[`üíß `,e.humidity,`%`]})]}),(0,N.jsx)(`div`,{className:`
        text-xs font-medium p-2 rounded
        ${n?`bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200`:`bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200`}
      `,children:t})]})}function K(e){let{data:t=[],isLoading:n,error:r}=o({queryKey:[`weather`,e],queryFn:()=>V(e),staleTime:1e3*60*30,enabled:!!e,retry:1});return{forecast:t,isLoading:n,error:r}}function q({timeline:e,city:t,date:n,onToggleVisited:r}){let i=t??e?.attractions[0]?.city??``,a=n??e?.date??``,{forecast:o}=K(i),c=a&&o.length>0?U(o,O(a)):null;return e?(0,N.jsxs)(`div`,{className:`space-y-6`,children:[a&&(c?(0,N.jsx)(G,{weather:c}):(0,N.jsx)(`div`,{className:`rounded-lg border border-amber-200 dark:border-amber-800 bg-amber-50 dark:bg-amber-900/20 p-4 text-amber-800 dark:text-amber-200 text-sm`,children:`Clima n√£o dispon√≠vel para esta data. A previs√£o cobre apenas os pr√≥ximos 5 dias.`})),(0,N.jsx)(`div`,{className:`bg-gradient-to-br from-slate-600 to-slate-700 dark:from-slate-700 dark:to-slate-800 text-white rounded-2xl p-5 md:p-6 shadow-lg`,children:(0,N.jsxs)(`div`,{className:`space-y-4`,children:[(0,N.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,N.jsxs)(`div`,{className:`text-sm font-medium opacity-90 mb-1`,children:[`Dia `,e.dayNumber]}),(0,N.jsx)(`h2`,{className:`text-lg md:text-3xl font-bold mb-2 capitalize`,children:C(e.date)})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-2 text-base md:text-lg opacity-90`,children:[(0,N.jsx)(s,{className:`w-5 h-5`}),(0,N.jsx)(`span`,{className:`font-semibold`,children:e.startTime}),(0,N.jsx)(`span`,{children:`‚Üí`}),(0,N.jsx)(`span`,{className:`font-semibold`,children:e.endTime})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-6 pt-4 border-t border-white/20 text-sm md:text-base`,children:[(0,N.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,N.jsx)(u,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,N.jsxs)(`div`,{children:[(0,N.jsx)(`div`,{className:`font-bold text-md:text-xl`,children:e.attractions.length}),(0,N.jsx)(`div`,{className:`text-xs opacity-75`,children:`locais`})]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,N.jsx)(g,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,N.jsxs)(`div`,{children:[(0,N.jsxs)(`div`,{className:`font-bold text-md md:text-xl`,children:[e.totalDistance.toFixed(1),` km`]}),(0,N.jsx)(`div`,{className:`text-xs opacity-75`,children:`dist√¢ncia`})]})]}),(0,N.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,N.jsx)(s,{className:`w-5 h-5 md:w-6 md:h-6`}),(0,N.jsxs)(`div`,{children:[(0,N.jsxs)(`div`,{className:`font-bold text-md md:text-xl`,children:[e.totalTravelTime,`min`]}),(0,N.jsx)(`div`,{className:`text-xs opacity-75`,children:`viagem`})]})]})]}),e.conflicts.length>0&&(0,N.jsxs)(`div`,{className:`mt-4 bg-white/10 backdrop-blur rounded-xl p-4 flex items-start gap-3`,children:[(0,N.jsx)(m,{className:`w-6 h-6 flex-shrink-0 mt-0.5`}),(0,N.jsxs)(`div`,{children:[(0,N.jsxs)(`div`,{className:`font-semibold text-base`,children:[e.conflicts.length,` `,e.conflicts.length===1?`conflito detectado`:`conflitos detectados`]}),(0,N.jsx)(`div`,{className:`text-sm opacity-90 mt-1`,children:`Verifique os avisos abaixo`})]})]})]})}),(0,N.jsxs)(`div`,{className:`relative pl-3 md:pl-6 pt-2`,children:[(0,N.jsx)(`div`,{className:`absolute left-0 top-0 bottom-0 w-0.5 bg-gray-200 dark:bg-gray-700 rounded-full`,"aria-hidden":!0}),(0,N.jsx)(`div`,{className:`space-y-6`,children:e.attractions.map((t,n)=>{let i=n>0?e.segments[n-1]:null,a=e.conflicts.filter(e=>e.attractionId===t.id),o=t.arrivalTime||e.startTime,s=t.departureTime||e.startTime,c=t.duration||60;return(0,N.jsxs)(`div`,{className:`relative`,children:[i&&(0,N.jsx)(I,{segment:i}),(0,N.jsx)(F,{attraction:t,arrivalTime:o,departureTime:s,duration:c,conflicts:a,onToggleVisited:r})]},t.id)})})]})]}):(0,N.jsxs)(`div`,{className:`text-center py-12`,children:[(0,N.jsx)(l,{className:`w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-3`}),(0,N.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400`,children:`Nenhuma atra√ß√£o para mostrar na timeline`}),(0,N.jsx)(`p`,{className:`text-sm text-gray-500 dark:text-gray-400 mt-1`,children:`Adicione atra√ß√µes com coordenadas para visualizar o roteiro`})]})}function J(e,t){if(e.length===0||t.length===0)return e;let n=e[0].city,r=t.find(e=>e.city===n);return!r?.lat||!r?.lng?e:[{id:-999,name:r.description,lat:r.lat,lng:r.lng,city:r.city,region:e[0].region,country:r.country,order:0,date:e[0].date,day:e[0].day,dayOfWeek:e[0].dayOfWeek,type:`other`,duration:0,couplePrice:0,priceInBRL:0,currency:e[0].currency,visited:!1,needsReservation:!1,openingTime:void 0,closingTime:void 0,imageUrl:void 0},...e]}function Y(){let{country:e,day:t,accommodations:n,attractions:r,isReady:o}=T(),{toggleVisited:s}=D(e),{segmentsByDay:c,isRoutesLoading:u}=j((0,M.useMemo)(()=>{let e={};return r.filter(e=>e.lat!=null&&e.lng!=null).forEach(t=>{e[t.day]||(e[t.day]=[]),e[t.day].push(t)}),e},[r]),n),{success:d,error:f}=w(),[p,m]=(0,M.useState)(!1),h=async e=>{try{await s(e),d(`Status da atra√ß√£o atualizado`)}catch(e){f(`Erro ao atualizar atra√ß√£o`),console.error(e)}},g=(0,M.useMemo)(()=>r.filter(e=>e.lat&&e.lng),[r]),v=(0,M.useMemo)(()=>g.length===0||t===`all`?[]:J(g.filter(e=>e.day===t),n),[g,t,n]),y=(0,M.useMemo)(()=>{if(t!==`all`||g.length===0)return[];let e={};return g.forEach(t=>{e[t.day]||(e[t.day]=[]),e[t.day].push(t)}),Object.keys(e).map(Number).sort((e,t)=>e-t).map(t=>{let r=e[t],i=J(r,n);return{day:t,date:r[0].date,attractions:i}})},[t,g,n]),b=(0,M.useMemo)(()=>t===`all`?y.length===0?`Todos os dias`:`${y.length} ${y.length===1?`dia`:`dias`}`:v.length===0?``:`Dia ${t}`,[t,y.length,v.length]),x=t===`all`?y.length>0:v.length>0,S=(0,M.useMemo)(()=>t===`all`?JSON.stringify(y.map(e=>({day:e.day,ids:e.attractions.map(e=>e.id)}))):JSON.stringify(v.map(e=>e.id)),[t,y,v]),[C,O]=(0,M.useState)(null),[P,F]=(0,M.useState)([]),[I,L]=(0,M.useState)(!1);return(0,M.useEffect)(()=>{if(u)return;if(t!==`all`){if(v.length===0){O(null),L(!1);return}let e=!1;L(!0),F([]);let n=c[Number(t)];return A(v,n&&n.length===v.length-1?n:void 0).then(t=>{e||O(t)}).finally(()=>{e||L(!1)}),()=>{e=!0}}if(y.length===0){F([]),O(null),L(!1);return}let e=!1;return L(!0),O(null),Promise.all(y.map(e=>{let t=c[e.day],n=t&&t.length===e.attractions.length-1?t:void 0;return A(e.attractions,n)})).then(t=>{e||F(t)}).finally(()=>{e||L(!1)}),()=>{e=!0}},[S,c,u]),o?(0,N.jsxs)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-6`,children:[(0,N.jsx)(k,{title:`Timeline`,subtitle:`${b} - Visualize seu dia com rotas e clima`,filter:(0,N.jsx)(E,{hideGeneralOption:!0}),action:x?(0,N.jsxs)(`button`,{type:`button`,onClick:async()=>{if(x){m(!0);try{let{exportTimelineToPDF:e}=await a(async()=>{let{exportTimelineToPDF:e}=await import(`./exportTimelineToPDF-BcWLsjUO.js`);return{exportTimelineToPDF:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]));if(t===`all`){let t=(P.length===y.length?P:await Promise.all(y.map(e=>{let t=c[e.day],n=t&&t.length===e.attractions.length-1?t:void 0;return A(e.attractions,n)}))).filter(e=>e!=null);t.length>0?(e(t),d(`PDF exportado com sucesso!`)):f(`Nenhuma timeline gerada para exportar`)}else{let n=c[Number(t)],r=n&&n.length===v.length-1?n:void 0,i=C??await A(v,r);i?(e([i]),d(`PDF exportado com sucesso!`)):f(`Nenhuma timeline gerada para exportar`)}}catch(e){console.error(e),f(`Erro ao exportar PDF`)}finally{m(!1)}}},disabled:p,className:`flex items-center gap-2 px-3 py-2 rounded-lg bg-white/20 hover:bg-white/30 text-white text-sm font-medium transition-colors disabled:opacity-60 disabled:cursor-not-allowed`,title:`Exportar timeline em PDF`,children:[(0,N.jsx)(_,{className:`w-4 h-4`}),p?`Exportando‚Ä¶`:`Exportar PDF`]}):void 0}),(0,N.jsxs)(`main`,{className:`max-w-6xl mx-auto px-4 md:px-6 py-6`,children:[!1,(t===`all`?y.length===0:v.length===0)?(0,N.jsxs)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-12 text-center`,children:[(0,N.jsx)(l,{className:`w-16 h-16 text-gray-400 mx-auto mb-4`}),(0,N.jsx)(`h3`,{className:`text-xl font-bold text-gray-900 dark:text-gray-100 mb-2`,children:t===`all`?`Nenhuma atra√ß√£o com coordenadas`:`Nenhuma atra√ß√£o para o Dia ${t}`}),(0,N.jsx)(`p`,{className:`text-gray-600 dark:text-gray-400 mb-4`,children:t===`all`?`Adicione coordenadas (lat/lng) √†s suas atra√ß√µes para visualizar as timelines por dia`:`Adicione coordenadas (lat/lng) √†s suas atra√ß√µes para visualizar a timeline`}),(0,N.jsx)(i,{to:`/attractions`,className:`inline-block px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors`,children:`Ir para Atra√ß√µes`})]}):u?(0,N.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center`,children:(0,N.jsx)(`p`,{className:`text-gray-500 dark:text-gray-400 text-sm`,children:`Carregando rotas em segundo plano...`})}):I?(0,N.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-12 flex items-center justify-center min-h-[200px]`,children:(0,N.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-2 border-gray-200 dark:border-gray-700 border-t-slate-600 dark:border-t-slate-400`})}):t===`all`?(0,N.jsx)(`div`,{className:`space-y-10`,children:y.map((e,t)=>(0,N.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-6`,children:(0,N.jsx)(q,{timeline:P[t]??null,city:e.attractions[0]?.city,date:e.date,onToggleVisited:h})},e.day))}):(0,N.jsx)(`div`,{className:`bg-white dark:bg-gray-800 rounded-xl shadow-md p-6`,children:(0,N.jsx)(q,{timeline:C,city:v[0]?.city,date:v[0]?.date,onToggleVisited:h})})]}),(t===`all`?y.length>0:v.length>0)&&(0,N.jsx)(`div`,{className:`max-w-6xl mx-auto px-6 pb-6`,children:(0,N.jsxs)(`div`,{className:`bg-blue-50 border border-blue-200 rounded-lg p-4`,children:[(0,N.jsxs)(`h4`,{className:`font-semibold text-blue-900 mb-2 flex items-center gap-2`,children:[(0,N.jsx)(l,{className:`w-4 h-4`}),`Como funciona a Timeline`]}),(0,N.jsxs)(`ul`,{className:`text-sm text-blue-800 space-y-1`,children:[(0,N.jsx)(`li`,{children:`‚Ä¢ Rotas calculadas automaticamente usando OSRM`}),(0,N.jsx)(`li`,{children:`‚Ä¢ Tempo de deslocamento estimado com base na dist√¢ncia`}),(0,N.jsx)(`li`,{children:`‚Ä¢ Conflitos detectados automaticamente (hor√°rios, fechamentos)`}),(0,N.jsx)(`li`,{children:`‚Ä¢ Dura√ß√£o: use o campo "Dura√ß√£o" da atra√ß√£o (padr√£o: 60min se n√£o informado)`}),(0,N.jsx)(`li`,{children:`‚Ä¢ Use o filtro na home para selecionar o dia da timeline`})]})]})})]}):(0,N.jsx)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center`,children:(0,N.jsx)(`div`,{className:`animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600`})})}export{Y as default};