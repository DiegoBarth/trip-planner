import{S as e,c as t,x as n}from"./google-login-button-DyA0rimH.js";import"./router-CBHNA5n3.js";import{F as r,T as i,V as a,b as o,y as s}from"./ui-icons-B3vgkW9X.js";import"./clsx-CVVEMLal.js";import"./utils-BsSA53OC.js";import"./react-query-DywLgQAp.js";import"./ThemeContext-BBJxRaNV.js";import{_ as c,f as l,g as u,m as d,n as f,v as p}from"./CountryContext-nFpLVFvs.js";import{n as m,t as h}from"./DateField-C4bgm9P7.js";import{a as g,i as _,l as v,o as y,p as b,r as x,s as S}from"./formatters-BV6Uspa7.js";import{n as C}from"./toast-D9R8ILnq.js";import{t as w}from"./EmptyState-CIl8gzwZ.js";import"./useMediaQuery-C3fFZaRf.js";import{i as T,n as E,r as D,t as O}from"./validateWithToast-ChD3ujdw.js";import{t as k}from"./useFocusTrap-BJKI3tkf.js";import"./CustomSelect-B5ckRW33.js";import"./FilterSheetContext-Dzz7lH-L.js";import{t as A}from"./PageHeader-CChIYzNA.js";import{n as j,t as M}from"./ConfirmModal-CpsJNzW3.js";import{t as N}from"./BudgetOriginFilter-DlsHbXyQ.js";var P=e(),F=n();function I({budget:e,onClick:n}){let r=t[e.origin];return(0,F.jsx)(`div`,{role:n?`button`:void 0,tabIndex:n?0:void 0,onClick:()=>n?.(e),onKeyDown:t=>{n&&(t.key===`Enter`||t.key===` `)&&(t.preventDefault(),n(e))},className:`group bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden border-l-4 transition-all ${n?`cursor-pointer hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-emerald-500/50`:``}`,style:{borderLeftColor:r.color},children:(0,F.jsxs)(`div`,{className:`p-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-3 min-w-0`,children:[(0,F.jsx)(`div`,{className:`w-11 h-11 rounded-xl flex items-center justify-center text-xl flex-shrink-0`,style:{backgroundColor:`${r.color}18`},children:r.icon}),(0,F.jsx)(`h3`,{className:`font-semibold text-gray-900 dark:text-gray-100 truncate min-w-0 flex-1`,title:e.description,children:e.description}),(0,F.jsx)(`span`,{className:`text-lg font-bold tabular-nums flex-shrink-0 text-emerald-500 dark:text-emerald-400`,children:y(e.amount)})]}),(0,F.jsxs)(`div`,{className:`pt-3 border-gray-100 dark:border-gray-700 flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400`,children:[(0,F.jsx)(o,{className:`w-4 h-4 text-gray-400 flex-shrink-0`}),(0,F.jsx)(`span`,{children:v(e.date)})]})]})})}const L=c({origin:d([`Diego`,`Pamela`,`Casal`,`AlimentaÃ§Ã£o`,`AtraÃ§Ãµes`,`Transporte`],{message:`Origem do orÃ§amento Ã© obrigatÃ³ria`}),description:p().trim().min(1,`A DescriÃ§Ã£o Ã© obrigatÃ³ria`),amount:u().positive(`O Valor Ã© obrigatÃ³rio`),date:m({message:`A Data Ã© obrigatÃ³ria`})});L.extend({id:u({message:`ID Ã© obrigatÃ³rio.`})});var R={origin:`Diego`,description:``,amount:``,date:new Date().toISOString().split(`T`)[0]};function z({budget:e,isOpen:n,onClose:r,onSave:i}){let a=C(),[o,s]=(0,P.useState)(!1),{control:c,register:l,handleSubmit:u,reset:d,setValue:f,watch:p}=T({defaultValues:R}),m=p(`origin`);return(0,P.useEffect)(()=>{if(n)if(e){let t=Math.round(e.amount*100);d({origin:e.origin,description:e.description,amount:S(t.toString()),date:_(e.date)})}else d(R)},[n,e,d]),(0,F.jsx)(E,{isOpen:n,onClose:r,title:e?`Editar OrÃ§amento`:`Novo OrÃ§amento`,type:e?`edit`:`create`,onSave:u(async e=>{let t=typeof e.amount==`string`?x(e.amount):e.amount,n={origin:e.origin,description:e.description,amount:t||0,date:e.date};if(O(n,L,a)){s(!0);try{await Promise.resolve(i(n)),d(R),r()}finally{s(!1)}}}),loading:o,loadingText:`Salvando...`,size:`md`,children:(0,F.jsxs)(`div`,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Origem do OrÃ§amento *`}),(0,F.jsx)(`div`,{className:`grid grid-cols-3 gap-2`,children:Object.entries(t).map(([e,t])=>(0,F.jsxs)(`button`,{type:`button`,onClick:()=>f(`origin`,e),className:`p-3 rounded-lg border-2 transition-all focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none  ${m===e?`border-current shadow-md`:`border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500`}`,style:{borderColor:m===e?t.color:void 0,backgroundColor:m===e?`${t.color}10`:void 0},children:[(0,F.jsx)(`div`,{className:`text-2xl mb-1`,children:t.icon}),(0,F.jsx)(`div`,{className:`font-semibold text-sm text-gray-500 dark:text-gray-400`,style:{color:m===e?t.color:void 0},children:t.label})]},e))})]}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`label`,{htmlFor:`budget-description`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`DescriÃ§Ã£o *`}),(0,F.jsx)(`input`,{id:`budget-description`,type:`text`,required:!0,"aria-required":`true`,autoComplete:`off`,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none`,placeholder:`Ex: OrÃ§amento inicial da viagem`,...l(`description`)})]}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`label`,{htmlFor:`budget-amount`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Valor (R$) *`}),(0,F.jsx)(D,{name:`amount`,control:c,render:({field:e})=>(0,F.jsx)(`input`,{id:`budget-amount`,type:`text`,required:!0,"aria-required":`true`,"aria-label":`Valor do or\\u00e7amento em reais`,autoComplete:`off`,className:`w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:ring-2 focus:ring-gray-300 dark:focus:ring-gray-500 focus:outline-none`,placeholder:`0,00`,value:e.value,onChange:t=>e.onChange(S(t.target.value))})})]}),(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`label`,{htmlFor:`budget-date`,className:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5`,children:`Data *`}),(0,F.jsx)(D,{name:`date`,control:c,render:({field:e})=>(0,F.jsx)(h,{value:e.value?b(e.value):void 0,onChange:t=>e.onChange(t?g(t):``),required:!0})})]})]})})}function B({budget:e,isOpen:n,onClose:i,onEdit:o,onDelete:c}){let l=k(n);if((0,P.useEffect)(()=>{if(!n)return;function e(e){e.key===`Escape`&&i()}return document.addEventListener(`keydown`,e),()=>document.removeEventListener(`keydown`,e)},[n,i]),!n||!e)return null;let u=t[e.origin],d=()=>{i(),o(e)},f=()=>{i(),c(e)};return(0,F.jsxs)(`div`,{className:`fixed inset-0 z-[600] flex justify-center items-end md:items-center`,role:`dialog`,"aria-modal":`true`,"aria-labelledby":`budget-actions-title`,children:[(0,F.jsx)(`div`,{className:`absolute inset-0 bg-black/40 backdrop-blur-sm`,onClick:i,"aria-hidden":`true`}),(0,F.jsxs)(`div`,{ref:l,className:`relative w-full max-w-sm bg-white dark:bg-gray-800 rounded-t-2xl md:rounded-2xl shadow-2xl flex flex-col`,children:[(0,F.jsxs)(`div`,{className:`flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700`,children:[(0,F.jsx)(`h2`,{id:`budget-actions-title`,className:`text-lg font-semibold text-gray-900 dark:text-gray-100 truncate pr-2`,children:e.description}),(0,F.jsx)(`button`,{type:`button`,onClick:i,"aria-label":`Fechar`,className:`p-2 rounded-lg text-gray-500 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700`,children:(0,F.jsx)(a,{className:`w-5 h-5`})})]}),(0,F.jsxs)(`div`,{className:`px-4 py-3 flex items-center justify-center gap-4 text-sm text-gray-500 dark:text-gray-400 flex-wrap`,children:[u&&(0,F.jsxs)(`span`,{className:`flex items-center gap-2`,children:[(0,F.jsx)(`span`,{children:u.icon}),(0,F.jsx)(`span`,{children:u.label})]}),(0,F.jsx)(`span`,{className:`font-semibold text-gray-700 dark:text-gray-300`,children:y(e.amount)})]}),(0,F.jsxs)(`div`,{className:`flex gap-3 px-4 py-4 border-t border-gray-200 dark:border-gray-700`,children:[(0,F.jsxs)(`button`,{type:`button`,onClick:d,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none`,children:[(0,F.jsx)(s,{className:`w-4 h-4`}),`Editar`]}),(0,F.jsxs)(`button`,{type:`button`,onClick:f,className:`flex-1 flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg focus:ring-2 focus:ring-red-500 focus:outline-none`,children:[(0,F.jsx)(r,{className:`w-4 h-4`}),`Excluir`]})]})]})]})}function V({budgets:e,isLoading:n,onUpdate:r,onCreate:i,onDelete:a}){let[o,s]=(0,P.useState)(!1),[c,l]=(0,P.useState)(),[u,d]=(0,P.useState)(null),[f,p]=(0,P.useState)(null),m=C(),h=e.reduce((e,t)=>(e[t.origin]||(e[t.origin]=[]),e[t.origin].push(t),e),{});Object.keys(h).forEach(e=>{h[e].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())});let g=Object.keys(h).sort((e,n)=>{let r=t[e]?.label??e,i=t[n]?.label??n;return r.localeCompare(i,`pt-BR`)}),_=()=>{l(void 0),s(!1)},v=async e=>{try{c?await r({id:c.id,...e}):await i(e),_()}catch(e){console.error(`Error saving budget:`,e),m.error(`Erro ao salvar orÃ§amento`)}},y=async()=>{u&&(await a(u.id),d(null))},b=e=>{p(e)};return n?null:(0,F.jsxs)(`div`,{children:[(0,F.jsx)(`div`,{className:`space-y-8`,children:g.length===0?(0,F.jsx)(w,{icon:`ðŸ’µ`,title:`Nenhum orÃ§amento encontrado`,description:`Comece adicionando seu primeiro orÃ§amento!`}):g.map(e=>{let n=h[e],r=t[e];return(0,F.jsxs)(`section`,{className:`space-y-4`,children:[(0,F.jsxs)(`div`,{className:`flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-sm w-fit`,children:[(0,F.jsx)(`span`,{className:`text-xl`,children:r.icon}),(0,F.jsx)(`h3`,{className:`text-base font-semibold text-gray-900 dark:text-gray-100`,children:r.label}),(0,F.jsxs)(`span`,{className:`text-sm text-gray-500 dark:text-gray-400`,children:[n.length,` `,n.length===1?`item`:`itens`]})]}),(0,F.jsx)(`div`,{className:`grid grid-cols-1 md:grid-cols-2 gap-4`,children:n.map(e=>(0,F.jsx)(I,{budget:e,onClick:b},e.id))})]},e)})}),(0,F.jsx)(z,{budget:c,isOpen:o,onClose:_,onSave:v}),(0,F.jsx)(B,{budget:f,isOpen:!!f,onClose:()=>p(null),onEdit:e=>{p(null),l(e),s(!0)},onDelete:e=>{p(null),d(e)}}),(0,F.jsx)(M,{isOpen:!!u,onClose:()=>d(null),title:`Excluir orÃ§amento`,message:u?(0,F.jsxs)(F.Fragment,{children:[`Tem certeza que deseja excluir "`,u.description,`"?`]}):null,onConfirm:y})]})}function H(){let[e,t]=(0,P.useState)(!1),[n,r]=(0,P.useState)(`all`),{createBudget:a,updateBudget:o,deleteBudget:s}=l(),{budgets:c,isReady:u}=f(),d=C(),p=(0,P.useMemo)(()=>n===`all`?c:c.filter(e=>e.origin===n),[c,n]),m=async e=>{try{let t=await a(e);return d.success(`OrÃ§amento criado com sucesso!`),t}catch(e){throw console.error(`Error creating budget:`,e),d.error(`Erro ao criar orÃ§amento`),e}};return(0,F.jsxs)(`div`,{className:`min-h-screen bg-gray-50 dark:bg-gray-900 pb-20 md:pb-6`,children:[(0,F.jsx)(A,{title:`OrÃ§amento`,subtitle:`Gerencie o orÃ§amento da sua viagem`,filter:(0,F.jsx)(N,{value:n,onChange:r})}),(0,F.jsx)(`main`,{className:`max-w-6xl mx-auto px-4 md:px-6 py-6 mb-12`,children:(0,F.jsx)(V,{budgets:p,isLoading:!u,onCreate:m,onUpdate:async e=>{try{let t=await o(e);return d.success(`OrÃ§amento atualizado com sucesso!`),t}catch(e){throw console.error(`Error updating budget:`,e),d.error(`Erro ao atualizar orÃ§amento`),e}},onDelete:async e=>{try{await s(e),d.success(`OrÃ§amento excluÃ­do com sucesso!`)}catch(e){console.error(`Error deleting budget:`,e),d.error(`Erro ao excluir orÃ§amento`)}}})}),(0,F.jsx)(j,{onClick:()=>t(!0),icon:(0,F.jsx)(i,{className:`w-6 h-6`}),label:`Adicionar`}),e&&(0,F.jsx)(z,{isOpen:e,onClose:()=>t(!1),onSave:async e=>{await m(e),t(!1)}})]})}export{H as default};